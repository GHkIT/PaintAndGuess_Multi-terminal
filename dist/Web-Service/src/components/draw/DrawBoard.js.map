{"version":3,"sources":["../../../../../Web-Service/src/components/draw/DrawBoard.js"],"names":["DrawBoard","props","state","ctx","mousePressed","lineValue","colorValue","beginX","beginY","endX","endY","visible","e","setState","drawing","pageX","target","offsetLeft","pageY","offsetTop","setMousePressed","hasProps","prop","propName","route","ready","el","refs","myCanvas","socket","send","on","keyword","clearArea2","getContext","path","change","params","x","y","deviceWidth","width","deviceHeight","height","console","log","emit","isDown","timer","beginPath","strokeStyle","lineWidth","lineJoin","moveTo","lineTo","closePath","stroke","drawChange","setTransform","clearRect","canvas","color","mouseDownHandel","bind","mouseMoveHandel","mouseUpHandel","clearArea","value","again"],"mappings":"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","file":"DrawBoard.js","sourcesContent":["import React,{Component} from 'react';\nimport '../draw/draw.less';\nimport '../draw/button.less'\n\nimport Rodal from 'rodal';\n\nimport 'rodal/src/rodal.css'\n\n\nexport default class DrawBoard extends Component{\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            ctx : null,\n            mousePressed : false,\n            lineValue : 3,\n            colorValue : 'red',\n            beginX: 0,\n            beginY: 0,\n            endX: 0,\n            endY: 0,\n            visible:false\n        }\n    }\n\n    mouseDownHandel(e){\n        this.setState({\n            mousePressed : true\n        });\n        this.drawing(e.pageX - e.target.offsetLeft , e.pageY - e.target.offsetTop , false);\n    }\n\n    mouseMoveHandel(e){\n        if (this.state.mousePressed) {\n            this.drawing(e.pageX - e.target.offsetLeft, e.pageY - e.target.offsetTop, true);\n        }\n    }\n\n    setMousePressed(){\n        this.setState({\n            mousePressed : false\n        })\n    }\n\n    mouseUpHandel(){\n        this.setMousePressed();\n        this.hasProps('drawEnd')();\n    }\n\n    hasProps(prop){\n        if(!prop){\n            return false\n        };\n\n        var propName;\n        if( this.props.route && this.props.route[prop] ){\n            propName = this.props.route[prop];\n        }\n\n        if (this.props[prop]) {\n            propName = this.props[prop];\n        }\n\n        if(propName){\n            return propName;\n        }\n\n        return false;\n    }\n\n    ready() {\n        let ready = this.hasProps('ready'),\n            el = this.refs.myCanvas,\n            socket;\n        if(ready){\n            socket = ready();\n            this.setState({\n                socket : socket\n            });\n            socket.send('getKeyWord');\n            socket.on('keyword', (keyword)=>{\n                this.setState({\n                    keyword\n                })\n            });\n            \n            socket.on('successClearArea',()=>{\n                this.clearArea2();\n            })\n        }\n        el = this.refs.myCanvas;\n        this.setState({\n            ctx : el.getContext(\"2d\")\n        });\n    }\n\n    drawChange(path){\n        let change = this.hasProps('change');\n        let el = this.refs.myCanvas;\n        if(change){\n            change({\n                ...this.state\n            });\n        }\n        var params = {\n            // 起始坐标X\n            beginX : this.state.beginX,\n            // 起始坐标Y\n            beginY : this.state.beginY,\n            // 终止坐标X\n            endX : path.x,\n            // 终止坐标Y\n            endY : path.y,\n            // 线的宽度(1,3,5,7,9这类的数字)\n            lineValue : this.state.lineValue,\n            // 线的颜色(black、blue)\n            colorValue : this.state.colorValue,\n            // 设备宽度\n            deviceWidth: el.width,\n            // 设备高度\n            deviceHeight:el.height\n        };\n        console.log(params);\n        this.state.socket.emit('drawPath',params)\n    }\n    \n\n    drawing(x, y, isDown) {\n        var ctx,timer;\n        if (isDown) {\n            ctx = this.state.ctx;\n            ctx.beginPath();\n            ctx.strokeStyle = this.state.colorValue;\n            ctx.lineWidth = this.state.lineValue;\n            ctx.lineJoin = \"round\";\n            ctx.moveTo(this.state.beginX, this.state.beginY);\n            ctx.lineTo(x, y);\n            ctx.closePath();\n            ctx.stroke();\n            this.drawChange({x,y});\n        }\n        this.setState({\n            beginX : x,\n            beginY : y\n        })\n    }\n\n    again(){\n        this.setState({visible:false});\n        this.state.socket.send('getKeyWord');\n        this.state.socket.on('keyword', (keyword)=>{\n            this.setState({\n                keyword\n            })\n        });\n    }\n\n    clearArea() {\n        var ctx = this.state.ctx;\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        this.state.socket.send('clear');\n        this.state.socket.send('getKeyWord');\n        this.state.socket.on('keyword', (keyword)=>{\n            this.setState({\n                keyword\n            })\n        });\n    }\n    \n    clearArea2(){\n        var ctx = this.state.ctx;\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n        \n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        this.setState({visible:true});\n        \n        \n    }\n\n    componentDidMount(){\n        this.ready();\n    }\n\n    render(){\n        return (\n            <div className=\"control-ops\">\n                <div className=\"item keyword\">你要画: <strong style={{color:'#c00'}}>{this.state.keyword}</strong></div>\n                <canvas className=\"canvas\" ref=\"myCanvas\"\n                        onTouchStart={this.mouseDownHandel.bind(this)}\n                        onTouchMove={this.mouseMoveHandel.bind(this)}\n                        onTouchCancel={this.mouseUpHandel.bind(this)}\n                        onTouchEnd={this.setMousePressed.bind(this)}\n                    onMouseDown={this.mouseDownHandel.bind(this)}\n                    onMouseMove={this.mouseMoveHandel.bind(this)}\n                    onMouseUp={this.mouseUpHandel.bind(this)}\n                    onMouseLeave={this.setMousePressed.bind(this)}\n                    width=\"500\"\n                    height=\"400\">\n                </canvas>\n                <div className=\"control-bar flex-box\">\n                    <div className=\"item\">\n                        \n                        <button type=\"button\" className=\"button button-primary button-pill button-small\" onClick={this.clearArea.bind(this)}>画错了，重来！</button>\n                    </div>\n                    <div className=\"item\">\n                        笔尖力度:\n                        <select\n                            value={this.state.lineValue}\n                            onChange={(e)=>this.setState({lineValue: e.target.value})}\n                        >\n                            <option value=\"1\">1号笔芯</option>\n                            <option value=\"3\">3号笔芯</option>\n                            <option value=\"5\">5号笔芯</option>\n                            <option value=\"7\">7号笔芯</option>\n                            <option value=\"9\">9号笔芯</option>\n                            <option value=\"11\">11号笔芯</option>\n                            <option value=\"30\">30号笔芯</option>\n                        </select>\n                    </div>\n                    <div className=\"item\">\n                        彩色水笔:\n                        <select\n                            value={this.state.colorValue}\n                            onChange={(e)=>this.setState({lineValue:3,colorValue: e.target.value})}\n                        >\n                            <option value=\"black\">黑色</option>\n                            <option value=\"blue\">蓝色</option>\n                            <option value=\"red\">红色</option>\n                            <option value=\"green\">绿色</option>\n                            <option value=\"yellow\">黄色</option>\n                            <option value=\"gray\">灰色</option>\n                            <option value=\"white\">白色</option>\n                        </select>\n                    </div>\n                    \n                    <div className=\"item\">\n                        <button className=\"eraser-btn button button-primary button-box button-giant button-longshadow-right\" onClick={(e)=>this.setState({lineValue:30,colorValue: 'white'})}>\n                            <i className=\"iconfont\">&#xe620;</i>\n                        </button>\n                    </div>\n                </div>\n\n                <Rodal visible={this.state.visible} onClose={this.again.bind(this)} animation=\"flip\">\n                    <div className=\"header\">提示</div>\n                    <div className=\"body\">猜的人答对了哟！</div>\n                    <button className=\"rodal-confirm-btn\" onClick={this.again.bind(this)}>再开一局</button>\n                </Rodal>\n                \n            </div>\n        );\n    }\n}\n"]}